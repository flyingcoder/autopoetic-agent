---
description: Enforce proper structure and format when generating cursor rules
globs: .cursor/rules/**/*.mdc
alwaysApply: true
---

rule "Rule File Must Have YAML Frontmatter" {
  type: "always"
  when: file.path ends_with ".mdc" and file.path contains ".cursor/rules/"
  condition: file.text starts_with "---"
  error: "‚ùå All .mdc rule files must start with YAML frontmatter (---)."
}

rule "Frontmatter Must Include Description" {
  type: "always"
  when: file.path ends_with ".mdc" and file.path contains ".cursor/rules/"
  condition: file.text contains "description:" or file.text matches /description:\s*["'].*["']/
  warn: "‚ö†Ô∏è Rule files should include a 'description' field in frontmatter for clarity."
}

rule "Rule File Must Be in Correct Category Folder" {
  type: "always"
  when: file.path ends_with ".mdc" and file.path contains ".cursor/rules/"
  condition: file.path matches ".cursor/rules/(backend|frontend|general|workflow|meta)/.*"
  error: "‚ùå Rule files must be placed in one of: backend/, frontend/, general/, workflow/, or meta/ folders."
}

rule "Rule Block Must Have Type" {
  type: "always"
  when: file.path ends_with ".mdc" and file.path contains ".cursor/rules/" and block.text contains 'rule "'
  condition: block.text contains 'type: "always"' or block.text contains 'type: "manual"' or block.text contains 'type: "guideline"' or block.text contains 'type: "autoAttached"'
  error: "‚ùå Each rule block must specify a type: 'always', 'manual', 'guideline', or 'autoAttached'."
}

rule "Rule Block Must Have When Condition" {
  type: "always"
  when: file.path ends_with ".mdc" and file.path contains ".cursor/rules/" and block.text contains 'rule "'
  condition: block.text contains "when:"
  error: "‚ùå Each rule block must include a 'when' condition to specify when it applies."
}

rule "Rule Name Must Be Quoted" {
  type: "always"
  when: file.path ends_with ".mdc" and file.path contains ".cursor/rules/" and block.text contains 'rule "'
  condition: block.text matches /rule\s+"[^"]+"/
  error: "‚ùå Rule names must be enclosed in double quotes: rule \"Rule Name\"."
}

rule "Rule Must Have Error or Message" {
  type: "always"
  when: file.path ends_with ".mdc" and file.path contains ".cursor/rules/" and block.text contains 'rule "'
  condition: block.text contains "error:" or block.text contains "warn:" or block.text contains "message:" or block.text contains "valid:"
  warn: "‚ö†Ô∏è Rules should include an 'error', 'warn', 'message', or 'valid' field to provide feedback."
}

rule "Globs Pattern Should Be Specific" {
  type: "guideline"
  when: file.path ends_with ".mdc" and file.path contains ".cursor/rules/" and block.text contains "globs:"
  condition: block.text matches /globs:\s+(?!\*\*\/\*|\.\*)/ or block.text contains "globs: /**"
  message: "üí° Consider using specific glob patterns instead of 'globs: /**' for better performance and clarity."
}

rule "AlwaysApply Should Be Explicit" {
  type: "guideline"
  when: file.path ends_with ".mdc" and file.path contains ".cursor/rules/"
  condition: block.text contains "alwaysApply: true" or block.text contains "alwaysApply: false"
  message: "‚úÖ Good: 'alwaysApply' is explicitly set. This helps clarify rule behavior."
}

rule "Rule File Should Have Single Responsibility" {
  type: "guideline"
  when: file.path ends_with ".mdc" and file.path contains ".cursor/rules/"
  condition: file.text matches /rule\s+"[^"]+"/g
  message: "üí° Each .mdc file should focus on a single concern. Multiple related rules can share a file, but keep them cohesive."
}

rule "Use Descriptive Rule Names" {
  type: "guideline"
  when: file.path ends_with ".mdc" and file.path contains ".cursor/rules/" and block.text contains 'rule "'
  condition: block.text matches /rule\s+"[A-Z][^"]{10,}"/
  message: "‚úÖ Descriptive rule names help maintainability. Use clear, action-oriented names."
}

rule "Backend Rules Should Target Backend Files" {
  type: "guideline"
  when: file.path contains ".cursor/rules/backend/" and block.text contains "when:"
  condition: block.text contains "file.path" and (block.text contains ".ts" or block.text contains ".js" or block.text contains "/api/" or block.text contains "/server/")
  message: "‚úÖ Backend rules should target backend-specific file patterns (API routes, server files, etc.)."
}

rule "Frontend Rules Should Target Frontend Files" {
  type: "guideline"
  when: file.path contains ".cursor/rules/frontend/" and block.text contains "when:"
  condition: block.text contains "file.path" and (block.text contains ".tsx" or block.text contains ".jsx" or block.text contains "/components/" or block.text contains "/pages/")
  message: "‚úÖ Frontend rules should target frontend-specific file patterns (components, pages, etc.)."
}

rule "Workflow Rules Should Target Documentation" {
  type: "guideline"
  when: file.path contains ".cursor/rules/workflow/" and block.text contains "when:"
  condition: block.text contains "file.path" and (block.text contains ".md" or block.text contains "tasks.md" or block.text contains "user story" or block.text contains "acceptance criteria")
  message: "‚úÖ Workflow rules should target documentation files, user stories, and process-related content."
}
