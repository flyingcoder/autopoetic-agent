---
description: Self-improvement system for cursor rules - monitors codebase patterns and suggests rule improvements
globs: 
alwaysApply: true
---

rule "Rule Improvement Triggers" {
  type: "guideline"
  when: block.text contains "pattern" or block.text contains "repeated" or block.text contains "common" or file.path contains "/.cursor/rules/"
  message: |
    üîÑ **Rule Improvement Triggers:**
    
    Monitor for these patterns to improve rules:
    
    **New Code Patterns:**
    - New technology/pattern used in 3+ files
    - Framework updates or migrations
    - Library adoption across codebase
    
    **Repeated Implementations:**
    - Same pattern in multiple files (3+ occurrences)
    - Inconsistent approaches to same problem
    - Copy-paste code that should be standardized
    
    **Common Errors:**
    - Same bug appearing multiple times
    - Type errors that could be prevented
    - Runtime errors with identifiable patterns
    
    **Best Practices:**
    - Security improvements
    - Performance optimizations
    - Code quality improvements
    
    **Documentation Gaps:**
    - Patterns referenced in docs but not enforced
    - External documentation that should be codified
    - Team conventions not captured in rules
}

rule "Rule Analysis Process" {
  type: "guideline"
  when: file.path contains "/.cursor/rules/" or block.text contains "rule" and block.text contains "analysis"
  message: |
    üìä **Rule Analysis Process:**
    
    When analyzing codebase for rule improvements:
    
    1. **Compare new code with existing rules:**
       - Review `.cursor/rules/` for current coverage
       - Identify patterns that should be standardized
       - Look for references to external documentation
       - Check for consistent error handling patterns
       - Monitor test patterns and coverage
    
    2. **Identify patterns that should be standardized:**
       - Search for repeated code blocks (3+ occurrences)
       - Find similar function implementations
       - Identify common error handling approaches
       - Document library usage patterns
    
    3. **Extract examples from actual code:**
       - Use real code examples from codebase
       - Note file locations and context
       - Identify edge cases
       - Document variations
}

rule "Add New Rules When" {
  type: "guideline"
  when: block.text contains "new rule" or block.text contains "create rule" or file.path contains "/.cursor/rules/"
  message: |
    ‚ûï **Add New Rules When:**
    
    - A new technology/pattern is used in 3+ files
    - Common bugs could be prevented by a rule
    - Code reviews repeatedly mention the same feedback
    - New security or performance patterns emerge
    - Library is used consistently across codebase
    
    **Use `/generate-rule` command with appropriate template:**
    - `type-safety` - For type checking rules
    - `format-validation` - For format validation
    - `path-pattern` - For file path patterns
    - `keyword-detection` - For keyword-based rules
    - `file-structure` - For file organization
    - `workflow-format` - For workflow patterns
}

rule "Modify Existing Rules When" {
  type: "guideline"
  when: file.path contains "/.cursor/rules/" and block.text contains "update" or block.text contains "modify"
  message: |
    üîß **Modify Existing Rules When:**
    
    - Better examples exist in the codebase
    - Additional edge cases are discovered
    - Related rules have been updated
    - Implementation details have changed
    - Rule causes false positives or misses cases
    
    **Update Process:**
    1. Read the current rule file
    2. Identify what needs to change
    3. Update with better examples or additional cases
    4. Ensure backward compatibility where possible
    5. Document breaking changes if any
}

rule "Rule Quality Checks" {
  type: "guideline"
  when: file.path contains "/.cursor/rules/" or block.text contains "rule quality"
  message: |
    ‚úÖ **Rule Quality Standards:**
    
    Rules should be:
    
    - **Actionable:** Provide clear guidance, specific examples, helpful error messages
    - **Specific:** Avoid vague conditions, use concrete patterns, include edge cases
    - **Current:** Examples from actual codebase, up-to-date with latest patterns, current documentation references
    - **Enforceable:** Conditions can be reliably detected, validation is possible, false positives minimized
    
    **Validation Checklist:**
    - ‚úì YAML frontmatter with `---` delimiters
    - ‚úì Description field included
    - ‚úì Rule name in double quotes
    - ‚úì Rule type specified
    - ‚úì When condition defined
    - ‚úì Error/warn/message/valid field included
    - ‚úì Examples from actual code
    - ‚úì References are up to date
}

rule "Pattern Recognition Example" {
  type: "guideline"
  when: block.text contains "prisma" or block.text contains "database" or block.text contains "query"
  message: |
    üîç **Pattern Recognition Example:**
    
    If you see repeated patterns like:
    
    ```typescript
    // Pattern appears in 3+ files:
    const data = await prisma.user.findMany({
      select: { id: true, email: true },
      where: { status: 'ACTIVE' }
    });
    ```
    
    **Consider adding rule:**
    - Standardize select fields
    - Common where conditions
    - Performance optimization patterns
    - Use template: `type-safety` or `path-pattern`
    - Category: `backend/`
    
    Extract actual examples from codebase, not hypothetical ones.
}

rule "Continuous Improvement Checklist" {
  type: "guideline"
  when: file.path contains "/.cursor/rules/" or block.text contains "improve" or block.text contains "maintain"
  message: |
    üîÑ **Continuous Improvement:**
    
    **Weekly:**
    - Review recent code changes for new patterns
    - Check for repeated code review feedback
    - Monitor common development questions
    
    **Monthly:**
    - Analyze rule effectiveness
    - Update examples with latest code
    - Check for deprecated patterns
    - Review external documentation updates
    
    **Quarterly:**
    - Major rule refactoring if needed
    - Comprehensive pattern analysis
    - Rule consolidation review
    - Documentation audit
    
    **Always:**
    - Keep examples synchronized with code
    - Update references to external docs
    - Maintain links between related rules
    - Document breaking changes
}

rule "Rule Deprecation Process" {
  type: "guideline"
  when: file.path contains "/.cursor/rules/" and (block.text contains "deprecate" or block.text contains "remove")
  message: |
    üóëÔ∏è **Rule Deprecation:**
    
    **When to deprecate:**
    - Pattern no longer used in codebase
    - Better approach exists
    - Technology replaced
    - Rule causes more problems than it solves
    
    **Deprecation Process:**
    1. Mark rule with deprecation notice in frontmatter:
       ```yaml
       deprecated: true
       deprecatedSince: "YYYY-MM-DD"
       migrationPath: ".cursor/rules/new-rule.mdc"
       ```
    2. Update description to indicate deprecation
    3. Find all references and update to point to new rule
    4. Document migration path
    5. Remove after grace period (1-2 release cycles)
    
    **Never delete rules without:**
    - Deprecation notice period
    - Migration documentation
    - Reference updates
}

rule "Documentation Updates" {
  type: "guideline"
  when: file.path contains "/.cursor/rules/" or block.text contains "documentation"
  message: |
    üìö **Documentation Maintenance:**
    
    **Keep Examples Current:**
    - Update examples when code changes
    - Remove outdated examples
    - Add new patterns as they emerge
    
    **Update References:**
    - Check external documentation links
    - Update library versions
    - Verify best practices still apply
    
    **Maintain Cross-References:**
    - Link related rules
    - Update when rules change
    - Document dependencies
    
    **Document Breaking Changes:**
    - Note when rules change behavior
    - Provide migration guides
    - Update affected documentation
}
